## 2015-05-09:  (see domain n



virtualmin  create-domain  --domain  commptonpeslonline.com  --pass  abcdefg --dir  --unix  --dns  --web --ssh ;

to migrate virtualmin without data:
virtualmin  backup-domain                  \
    --domain  edwardsmark.com          \
    --dest   /tmp/x.tgz                            \
    --all-features --except-feature  dir   ;    ### --all-features gets webalizer which no longer appears to work.
https://www.virtualmin.com/documentation/developer/cli/backup_domain
https://www.virtualmin.com/documentation/developer/cli/restore_domain

virtualmin list-features;   ## 2026-02-06 VERY handy way to get all the features


virtualmin    list-domains  | cut  -f1  -d ' ' | grep -v  Domain  | grep -v "\-\-\-" | grep -v  comptonpeslonline.info  | sed -e 's/\(^.*\)/  --domain  \1/' 

#! /bin/bash  -w
#
#       virtualmin-backup-domains.bsh           2026-02-06
#
#
        virtualmin backup-domain                                        \
                --dest          /home/mark/virtualmin/virtualmin.tgz    \
                --feature       dns                                     \
                --feature       web                                     \
                --feature       ssl                                     \
                --feature       dir                                     \
                --all-virtualmin                                        \
                --domain        accentreduction.online                  \
                --domain        ajcomptonpesl.com                       \
                --domain        carouselhouse.com                       \
                --domain        comptonpeslonline.com                   \
                --domain        edwardsmark.com                         \
                --domain        englishwithoutaccent.com                \
                --domain        gordonredwards.com                      \
                --domain        slrh.org                                \
                --domain        virtualaska.com                         \
                --domain        000-first.com                           \
                ;

exit;


#!  /bin/bash  -w
#virtualmin restore-domain  --source /home/mark/virtualmin.tgz   --all-virtualmin --all-domains   --feature dns --feature web --feature ssl  --feature  dir   &
 virtualmin restore-domain                                        \
                --source          /home/mark/virtualmin.tgz    \
                --all-virtualmin                                        \
                --feature       dns                                     \
                --feature       web                                     \
                --feature       ssl                                     \
                --feature       dir                                     \
                --domain        accentreduction.online                  \
                --domain        ajcomptonpesl.com                       \
                --domain        carouselhouse.com                       \
                --domain        comptonpeslonline.com                   \
                --domain        edwardsmark.com                         \
                --domain        englishwithoutaccent.com                \
                --domain        gordonredwards.com                      \
                --domain        slrh.org                                \
                --domain        virtualaska.com                         \
                --domain        000-first.com                           \
                ;

exit;





###  newformat has been eliminated virtualmin backup-domain   [--test] [--newformat]  --dest /tmp/virtualmin/xx.tgz     --all-domains    --all-features  --except-feature dir    --all-virtualmin ;
###          --test may also be eliminated  ??
###  newformat has been eliminated  virtualmin restore-domain  [--test] [--newformat]  --source /tmp/virtualmin/xx.tgz   --all-virtualmin --all-features  --all-domains ;


*BACKUP*

to backup a virtualmin (domain) server:

virtualmin backup-domain --domain englishwithoutaccent.com --dest /tmp/virtualmin/   --newformat   --all-features --all-virtualmin --exclude *.al ;

virtualmin backup-domain --domain  comptonpeslonline.com --dest /tmp/virtualmin/   --newformat   --all-features --all-virtualmin --exclude *.opus  ;   ## 2025-12-04  created 3.5 gig directory!
virtualmin backup-domain --all-domains  --dest /tmp/virtualmin/   --newformat   --all-features --all-virtualmin --exclude *.opus  ;                    ## 2025-12-04  created 5.2 gig

virtualmin backup-domain --all-domains                                                    \
      --dest        /tmp/virtualmin/                                                      \
      --newformat   --all-features --all-virtualmin                                       \
      --exclude  public_html/comptonPractice/user-recorded-audio-files/teacher/*.opus     \
      --exclude  public_html/voicefiles/*.opus                                            \
      --exclude  public_html/php/comptonCommunicate/voicefiles/*.opus                     \
      --exclude  public_html/DebugLogs/*.log                                              \
                                                                                          \
      --exclude  *.avi                                                                    \
      --exclude  *.gz                                                                     \
      --exclude  *.mov                                                                    \
      --exclude  *.mp3                                                                    \
      --exclude  *.mp4                                                                    \
      --exclude  *.ogg                                                                    \
      --exclude  *.wmv                                                                    \
      --exclude  *.zip                                                                    \
  ;
  


      --exclude  public_html/video/r_video.mp4video.mp4                                                      \
      --exclude  public_html/video/r_video.mp4                                                               \
      --exclude  public_html/video/final_consonant_ts.mp4video.mp4                                           \
      --exclude  public_html/SelfStudy/Website/WebsiteContent/Tutorial/PrimarySelfStudyTutorial.mp4          \
      --exclude  public_html/SelfStudy/Website/Documentation/Website/Tutorial/PrimarySelfStudyTutorial.mp4   \
      --exclude  public_html/downloads/diphthongs_2.mp4video.mp4                                             \
      --exclude  public_html/images/video/comptonVideo.wmv                                                   \
      --exclude  public_html/video/GettingStartedwiththePracticeProgram.mp4                                  \
      --exclude  public_html/video/voiced_voiceless_th.mp4video.mp4                                          \
      --exclude  public_html/video/review_practicing_online.avi                                              \
      --exclude  public_html/comptonPractice/video/Self-Study-Demo-Final.mp4                                 \
      --exclude  public_html/wp-content/uploads/2017/01/Self-Study-Demo-Final.mp4                            \
      --exclude  public_html/wp-content/uploads/2017/01/Self-Study-Demo-1.mp4                                \
      --exclude  public_html/zenphoto/albums/travels/petersburg-confederates-2013/100_0465.png               \
      --exclude  public_html/tribute/homeGroanMp3/DarcyFarrow.mp3                                            \
      --exclude  public_html/zenphoto/zenphoto-1.5.2.tar.gz                                                  \
      --exclude  public_html/zenphoto/zenphoto-1.5.1.tar.gz                                                  \
      --exclude  public_html/websounds/rivertourweb2.mov                                                     \
      --exclude  backup/java_permission_on_communication_page.avi.gz                                         \
      --exclude  public_html/tribute/homeGroanMp3/TheWanderer.mp3                                            \
      --exclude  public_html/DebugLogs/evalAuth0.log                                                         \
      --exclude  public_html/tribute/homeGroanOgg/DarcyFarrow.ogg                                          
      --exclude  public_html/images/video/comptonVideoOriginal.wmv                                           \


backup only virtualmin files:

virtualmin backup-domain --dest /tmp/virtualmin/                    --all-features --newformat                     --all-virtualmin ;
virtualmin backup-domain --dest /tmp/virtualmin/x.tgz       --all-domains   --all-features  --except-feature dir                    --all-virtualmin ;


=== did not work:  ===
backup to old format  (notice file name and directory in --dest  x.tgz )

 virtualmin backup-domain --all-domains --dest /tmp/virtualmin/x.tgz  --all-features --all-virtualmin --exclude *.al --exclude *.avi --exclude *.cgi --exclude *.com_web_alog --exclude *.css --exclude *.flv --exclude *.divx --exclude *.exe --exclude *.gif   ;

back to new format   --new-format:   (notice no file name in --dest, only directory)

 virtualmin backup-domain --all-domains --dest /tmp/virtualmin/   --new-format  --all-features --all-virtualmin --exclude *.al --exclude *.avi --exclude *.cgi --exclude *.com_web_alog --exclude *.css --exclude *.flv --exclude *.divx --exclude *.exe --exclude *.gif


RESTORE:

virtualmin  restore-domain  --test  --source /tmp/virtualmin  --all-virtualmin --all-features  --all-domains ;



DOES NOT WORK:

## virtualmin backup-domain --domain  comptonpeslonline.com --dest /tmp/virtualmin/   --newformat   --all-features --all-virtualmin  \
##               --exclude  public_html/voicefiles/*.opus  \
##               --exclude public_html/comptonPractice/user-recorded-audio-files/teacher/*.opus    ; ## 2025-12-05  notice RELATIVE path names
##


